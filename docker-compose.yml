version: "3"
services:
  dns-proxy:
    build: dns-proxy
    networks:
      test:
        ipv4_address: 172.28.1.2
  host:
    image: debian
    command: sleep infinity
    networks:
      test:
        ipv4_address: 172.28.1.3
  pihole:
    image: diginc/pi-hole
    networks:
      test:
        ipv4_address: 172.28.1.4
    ports:
      - "53:53/tcp"
      - "53:53/udp"
      - "80:80/tcp"
    environment:
      # enter your docker host IP here
      ServerIP: "0.0.0.0"
      DNS1: "172.28.1.2"
      DNS2: "no"
      WEBPASSWORD: "p3i1t4N1"
      DNSMASQ_LISTENING: "all"
    # Add your own custom hostnames you need for your domain
    #volumes:
    #  - "./pihole:/etc/pihole"
    #  - "./dnsmasq.d:/etc/dnsmasq.d"
    #  - "./log/pihole.log:/var/log/pihole.log"
    #restart: always
  dnss:
    networks:
      test:
        ipv4_address: 172.28.1.5
    ports:
      - "443:443/tcp"
      - "443:443/upd"
networks:
  test:
    driver: overlay
    ipam:
     config:
       - subnet: 172.28.0.0/16
